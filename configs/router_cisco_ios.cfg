!
hostname R1
!
ip domain-name example.local
crypto key generate rsa modulus 2048
!
interface GigabitEthernet0/0
 description Uplink to ISP
 ip address dhcp
 ip nat outside
 no shut
!
interface GigabitEthernet0/1
 description Trunk to SW1
 no shut
!
interface GigabitEthernet0/1.10
 encapsulation dot1Q 10
 ip address 10.0.10.1 255.255.255.0
 ip nat inside
!
interface GigabitEthernet0/1.20
 encapsulation dot1Q 20
 ip address 10.0.20.1 255.255.255.0
 ip nat inside
!
interface GigabitEthernet0/1.30
 encapsulation dot1Q 30
 ip address 10.0.30.1 255.255.255.0
 ip nat inside
!
interface GigabitEthernet0/1.40
 encapsulation dot1Q 40
 ip address 10.0.40.1 255.255.255.0
 ip nat inside
!
interface GigabitEthernet0/1.50
 encapsulation dot1Q 50
 ip address 10.0.50.1 255.255.255.0
 ip nat inside
!
ip access-list standard NAT_INSIDE
 permit 10.0.10.0 0.0.0.255
 permit 10.0.20.0 0.0.0.255
 permit 10.0.30.0 0.0.0.255
 permit 10.0.40.0 0.0.0.255
 permit 10.0.50.0 0.0.0.255
!
ip nat inside source list NAT_INSIDE interface GigabitEthernet0/0 overload
!
ip dhcp excluded-address 10.0.10.1 10.0.10.20
ip dhcp excluded-address 10.0.20.1 10.0.20.20
ip dhcp excluded-address 10.0.30.1 10.0.30.20
ip dhcp excluded-address 10.0.50.1 10.0.50.20
!
ip dhcp pool VLAN10_USERS
 network 10.0.10.0 255.255.255.0
 default-router 10.0.10.1
 dns-server 10.0.20.10 8.8.8.8
 domain-name example.local
!
ip dhcp pool VLAN20_SERVERS
 network 10.0.20.0 255.255.255.0
 default-router 10.0.20.1
 dns-server 10.0.20.10 8.8.8.8
 domain-name example.local
!
ip dhcp pool VLAN30_PRINTERS
 network 10.0.30.0 255.255.255.0
 default-router 10.0.30.1
 dns-server 10.0.20.10
!
ip dhcp pool VLAN50_GUEST
 network 10.0.50.0 255.255.255.0
 default-router 10.0.50.1
 dns-server 8.8.8.8 1.1.1.1
!
ip access-list extended ACL_USERS_TO_SERVERS
 permit tcp 10.0.10.0 0.0.0.255 10.0.20.10 0.0.0.0 eq 445
 permit tcp 10.0.10.0 0.0.0.255 10.0.20.10 0.0.0.0 eq 389
 deny   ip 10.0.10.0 0.0.0.255 10.0.20.0 0.0.0.255 log
 permit ip 10.0.10.0 0.0.0.255 any
!
ip access-list extended ACL_GUEST_INTERNET_ONLY
 deny   ip 10.0.50.0 0.0.0.255 10.0.0.0 0.255.255.255 log
 permit ip 10.0.50.0 0.0.0.255 any
!
line vty 0 4
 transport input ssh
 login local
!
username admin privilege 15 secret 5 $1$abc$hashplaceholder
!
banner motd ^
Unauthorized access prohibited.
^
!
end
